{%load static%}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://necolas.github.io/normalize.css/8.0.1/normalize.css">
    <link rel="stylesheet" href="{% static 'tachihome.css'%}">
    <title>Tachibana</title>
</head>
    <body>
    <div id='tachihome'>
        {% csrf_token %}
       
        <div class='topbar'>
            <button @click='loadhome'>Home</button>
            {% if user.is_authenticated %}
            <div><button @click='options = !options'>[[options ? 'Close' : 'Options']]</button>
                <ul v-if='options'>
                    <button @click='newpage = !newpage'>[[newpage ? 'Close New Page' : 'New Page']]</button>
                    <button @click='newpost = !newpost'>[[newpost ? 'Close New Post' : 'New Post']]</button>
                </ul>
            </div>
            <div v-if='Object.keys(loadedpost).length'><button @click='newcomment= !newcomment'>[[newcomment? 'Close Comment Box':'New Comment']]</button>
            </div>
            <h1>Welcome&nbsp;{{ user.username }}!&nbsp;<a href="{% url 'logout' %}">Logout</a></h1>
            {% else %}
            <h1>Hello, Orange Inpersonator!</h1>
            <p>You are not logged in. <a href="{% url 'login' %}">Login</a> <a href="{% url 'users:signup' %}">Sign Up</a></p>
            {% endif %}
            <span v-if='Object.keys(errornotes).length'>apples</span>
            <div class='searchbar'>üîç
                <input type='text' v-model='searchbar'>
            </div>
        </div>

        <div class='new' v-if='newpage === true'>
            
                <label for='name'>Page Name</label><input v-model='newpageput.name' id='name' required='Required'></input><br>
                <span v-model='newpageput.home = 1'></span>
                <label for='purpose'>Page Purpose</label><input v-model='newpageput.purpose' id='purpose' required='Required'></input><br>
                <label for='image'>Page Image (Not Required)</label><input v-model='newpageput.top_image' id='image'></input><br>
                <button @click='newpagepost'>Submit</button>
            
        </div>
        
        <div class='new' v-if='newpost === true'>
            
                <label for='title'>Post Title</label><input v-model='newpostput.title' id='title' required='Required'></input><br>
                <span v-model='newpostput.author = {{user.id}}'></span>
                <label for='image'>Post Image (Not Required)</label><input v-model='newpostput.image_head' id='iamge'></input><br>
                <label for='body'>Post Body</label><input v-model='newpostput.body' id='body' required='Required'></input><br>
                <label for='page'>Related Page</label><select v-model='newpostput.page' id='page' required='Required'>
                    <option  v-for='page in home' :value='page.id' :key='page.id'>[[page.name]]</option>
                </select><br>               
                <button @click='newpostpost'>Submit</button>
            
        </div>

        

        <div class='box' v-if='Object.keys(home).length'>
            <div class='page' v-for='page in home'>
                <div class='post' v-for='post in page.post_detail'>
                    <span v-if='page.top_image'><img class='pageimg' :src='page.top_image' ></span><button class='pagename' @click='loadpage(page)'>[[page.name]]</button></img> <span v-if='post.author'> Posted by <span v-if='post.user_detail.username'><button @click='loadprofile(post.user_detail)'>[[post.user_detail.username]]</button></span>
                    <span v-if='post.title'><h1><button @click='loadpost(post)'>[[post.title]]</button></h1></span>
                    <span v-if='post.image_head'><img class='postimg' :src='post.image_head'></span>
                    <span v-if='post.body'><p class='body'>[[post.body]]</p></span>
                    <div class='postbot'>
                        <div class='rate'><button @click='postrateup(post)'>‚Üë</button><p>[[post.rate]]</p><button @click='postratedown(post)'>‚Üì</button></div><div class='coms'><p></p></div>
                    </div>
                </div>
            </div>
        </div>

        <div class='box' v-if='Object.keys(loadedpage).length'>
            <span v-if='loadedpage.top_image'><img class='pageimg' :src='loadedpage.top_image'><button class='pagename'  @click='loadpage(page)'>[[loadedpage.name]]</button></img>

            <div class='page'>
                <div class='post' v-for='post in loadedpage.post_detail'>
                    <span v-if='post.author'> Posted by <span v-if='post.user_detail.username'><button @click='loadprofile(post.user_detail)'>[[post.user_detail.username]]</button></span></span>
                    <span v-if='post.title'><h1><button @click='loadpost(post)'>[[post.title]]</button></h1></span>
                    <span v-if='post.image_head'><img class='postimg' :src='post.image_head'></span>
                    <span v-if='post.body'><p>[[post.body]]</p></span>
                    <div class='postbot'>
                    <div class='rate'><button @click='postrateup(post)'>‚Üë</button><p>[[post.rate]]</p><button @click='postratedown(post)'>‚Üì</button></div><div class='coms'><p></p></div>
                    </div>      
                </div>
            </div>
        </div>

        <div class='box' v-if='Object.keys(loadedpost).length'>
            <div class='new' v-if='newcomment === true'>
            
                <span v-model='newpostcomment.author = {{user.id}}'></span>
                <label for='body'>Post Body</label><input v-model='newpostcomment.body' id='body' required='Required'></input><br>
                <span v-model='newpostcomment.post = loadedpost.id'></span>
                <button @click='newcommentpost'>Submit</button>
            
        </div>
            <div class='page'>
                <div class='post'>
                    <span v-if='loadedpost.author'> Posted by <span v-if='loadedpost.user_detail.username'><button @click='loadprofile(loadedpost.user_detail.username)'>[[loadedpost.user_detail.username]]</button></span></span>
                    <span v-if='loadedpost.title'><h1><a @click='loadedpost(post)'>[[loadedpost.title]]</a></h1></span>
                    <span v-if='loadedpost.image_head'><img class='postimg' :src='loadedpost.image_head'></span>
                    <span v-if='loadedpost.body'><p>[[loadedpost.body]]</p></span>
                    <div class='rate'><button @click='postrateup(loadedpost)'>‚Üë</button><p>[[loadedpost.rate]]</p><button @click='postratedown(loadedpost)'>‚Üì</button></div><div class='coms'><p></p></div>
                </div>

                <div>
                    <span v-if='loadedpost.com_detail'>
                        <span  v-for='com in loadedpost.com_detail'>
                            <div class='com'>
                            <button @click='loadprofile(com.user_detail)'>[[com.user_detail.username]]</button>
                            <p class='combody'>[[com.body]]</p>
                            <div class='rate'><button @click='comrateup(com)'>‚Üë</button><p>[[com.rate]]</p><button @click='comratedown(com)'>‚Üì</button></div>
                            </div>
                        </span>
                </div>
            </div>
        </div>

            {% if user.is_authenticated %}
            <div class='fpage'></div>
            {% endif %}
        
    </div>
    <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="{% static 'tachihome.js'%}"></script>
    </body>
</head>